<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title> CMU Bomb Lab Phase 4 </title><link href=/menu_icon/favicon.svg rel=icon type=image/png><link href="https://await.cl/ atom.xml" title="Alvaro's Blog" rel=alternate type=application/atom+xml><link href=https://await.cl/main.css media=screen rel=stylesheet><script>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><meta content="A personal portfolio/blog website of Alvaro Parker del Fierro" name=description><meta content="A personal portfolio/blog website of Alvaro Parker del Fierro" name=description><meta content="index, nofollow" name=robots><meta content="Alvaro's Blog" property=og:title><meta content=article property=og:type><meta content=/menu_icon/profile_pic.jpg property=og:image><meta content=/menu_icon/profile_pic.jpg name=twitter:card><meta content=https://await.cl/posts/cmu-phase4/ property=og:url><meta content="A personal portfolio/blog website of Alvaro Parker del Fierro" property=og:description><meta content="Alvaro's Blog" property=og:site_name><body><header><div class=navbar><div class="nav-title nav-navs"><a class="nav-links home-title" href=https://await.cl>Alvaro's Blog</a></div><nav class="nav-title nav-navs"><a class=nav-links href=/projects> <img alt=Projects height=15 src=/menu_icon/projects.png width=15> Projects</a><a class=nav-links href=/about> <img alt=About height=15 src=/menu_icon/profile_pic.jpg width=15> About</a></nav><nav class="socials nav-navs"><label class=theme-switcher for=themeswitch><div class=background></div> <input id=themeswitch type=checkbox> <div class=switch><img alt="theme switch to dark" class=moon src=/menu_icon/moon.png><img alt="theme switch to light" class=sun src=/menu_icon/sun.png></div></label></nav></div></header><div class=content><main><article><div class=title><h2>CMU Bomb Lab Phase 4</h2><div class=meta>Posted on <time>2024-09-04</time><div class=post-tags><nav class="nav tags">üè∑: <a href=https://await.cl/tags/cmu-bomb/>CMU Bomb</a> ¬† <a href=https://await.cl/tags/reverse-engineering/>Reverse Engineering</a> ¬† <a href=https://await.cl/tags/code/>Code</a> ¬†</nav></div> ||<span> 8 minute read</span></div></div><h1>Table of Contents</h1><ul><li><a href=https://await.cl/posts/cmu-phase4/#cmu-bomb-lab-reverse-engineering>CMU Bomb Lab reverse engineering</a> <ul><li><a href=https://await.cl/posts/cmu-phase4/#phase-4>Phase 4</a></ul></ul><section class=body><h1 id=cmu-bomb-lab-reverse-engineering>CMU Bomb Lab reverse engineering</h1><h2 id=phase-4>Phase 4</h2><p>We are now on the phase 4, let's analyze the function <code>phase_4</code> by running <code>disass phase_4</code> on <code>gdb</code>:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-constant z-character z-hexadecimal z-assembly">0x08048ce0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">0</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ce1</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">1</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ce3</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">3</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">sub</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x18</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ce6</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">6</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">edx</span><span class="z-source z-assembly">,</span><span class="z-support z-function z-directive z-assembly">DWORD</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">PTR</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-hexadecimal z-assembly">0x8</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ce9</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">9</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffffc</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cec</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">12</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">lea</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x4</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cef</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">15</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cf0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">16</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8049808</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cf5</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">21</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">edx</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cf6</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">22</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048860</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">@</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cfb</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">27</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cfe</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">30</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">cmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x1</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d01</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">33</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">jne</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048d09</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">41</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d03</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">35</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">cmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">DWORD</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">PTR</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x4</span><span class="z-source z-assembly">]</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x0</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d07</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">39</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">jg</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048d0e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">46</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d09</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">41</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x80494fc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">x</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">m</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d0e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">46</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffff4</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d11</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">49</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-support z-function z-directive z-assembly">DWORD</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">PTR</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x4</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d14</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">52</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d15</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">53</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048ca0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d1a</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">58</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d1d</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">61</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">cmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x37</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d20</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">64</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">je</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048d27</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">71</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d22</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">66</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x80494fc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">x</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">m</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d27</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">71</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d29</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">73</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">pop</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d2a</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">74</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">ret</span>
</span></code></pre><p>Between instructions <code>0</code> and <code>9</code> is our function prologue. Then the next instructions push the parameters to call the <code>sscanf</code> function:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-constant z-character z-hexadecimal z-assembly">0x08048cec</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">12</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">lea</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x4</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cef</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">15</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cf0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">16</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8049808</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cf5</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">21</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">edx</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cf6</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">22</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048860</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">@</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-entity z-name z-function z-assembly">#</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">I</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">r</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">i</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">k</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">r</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">r</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">v</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">f</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cfb</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">27</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cfe</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">30</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">cmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x1</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d01</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">33</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">jne</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048d09</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">41</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d03</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">35</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">cmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">DWORD</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">PTR</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x4</span><span class="z-source z-assembly">]</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x0</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d07</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">39</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">jg</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048d0e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">46</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d09</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">41</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x80494fc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">x</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">m</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">></span>
</span></code></pre><p>We load the effective address <code>ebp-0x4</code> and we push that address in the stack. This is a pointer to the scanned value that <code>sscanf</code> will produce. Next we push an address <code>0x8049808</code>, let's check what's the content of this address using <code>gdb</code>:<pre class=z-code><code><span class="z-text z-plain">(gdb) x/s 0x8049808
0x8049808:      "%d"
</span></code></pre><p>Huh, so the format string that we pass to <code>sscanf</code> is <code>"%d"</code> which means the function expects a number!<p>We can also check the memory that <code>edx</code> register is pointing to:<pre class=z-code><code><span class="z-text z-plain">(gdb) x/s $edx
0x804b770 &LTinput_strings+240>:  "10"
</span></code></pre><p>So we now know that we have a function call that in C might look like this:<pre class="language-c z-code" data-lang=c><code class=language-c data-lang=c><span class="z-source z-c"><span class="z-storage z-type z-c">int</span> num<span class="z-punctuation z-terminator z-c">;</span>
<span class="z-meta z-function-call z-c"><span class="z-variable z-function z-c">sscanf</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-string z-quoted z-double z-c"><span class="z-punctuation z-definition z-string z-begin z-c">"</span>&LTinput string><span class="z-punctuation z-definition z-string z-end z-c">"</span></span><span class="z-punctuation z-separator z-c">,</span> <span class="z-string z-quoted z-double z-c"><span class="z-punctuation z-definition z-string z-begin z-c">"</span><span class="z-constant z-other z-placeholder z-c">%d</span><span class="z-punctuation z-definition z-string z-end z-c">"</span></span><span class="z-punctuation z-separator z-c">,</span> <span class="z-keyword z-operator z-c">&</span>num</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></code></pre><p>After this, the instructions <code>30</code> and <code>33</code> check if the function <code>sscanf</code> succesfully scanned the input string, and if not, it triggers the bomb by jumping to instruction <code>41</code>. After this, if our <code>sscanf</code> was a success, we go to instruction instruction <code>35</code> which checks if our input is greater than <code>0</code>, if it's not, the bomb explotes by continuing to instruction <code>41</code>, if it is greater than 0, we go to instruction <code>46</code><p>Let's analyze the next portion of the <code>phase_4</code> function, assuming that our input was correct and greater than 0:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-constant z-character z-hexadecimal z-assembly">0x08048d0e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">46</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffff4</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d11</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">49</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-support z-function z-directive z-assembly">DWORD</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">PTR</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x4</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d14</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">52</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d15</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">53</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048ca0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d1a</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">58</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d1d</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">61</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">cmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x37</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d20</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">64</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">je</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048d27</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">71</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d22</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">66</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x80494fc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">x</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">m</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d27</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">71</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d29</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">73</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">pop</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048d2a</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">74</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">ret</span>
</span></code></pre><p>We allocate some space on the stack on the first instruction, we move the number we scanned with the previous <code>sscanf</code> call to the <code>eax</code> register, we push the register to the stack and we call the <code>func4</code> function.<p>After this function returns, we compare the return value it produced (that's on the <code>eax</code> register) with the literal <code>0x37</code>. If the return value is equal to <code>0x37</code> we jump to instruction <code>71</code> which returns the <code>phase_4</code> function, hence passing this phase.<p>Ok, so far we know that we have to input a number on phase 4, that number has to be greater than 0, and then this number is used as a parameter to call the <code>func4</code> function, which returns a value that is then compared with the literal <code>0x37</code>, if the return value is equal to <code>0x37</code> we pass the phase, if not, we explote the bomb.<p>Let's analyze <code>func4</code> to check what our input value should be such that the <code>func4</code> returns a value equal to <code>0x37</code>. Disassembling the function with <code>disass func4</code> returns:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">0</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca1</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">1</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca3</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">3</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">sub</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca6</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">6</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esi</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca7</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">7</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebx</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca8</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">8</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebx</span><span class="z-source z-assembly">,</span><span class="z-support z-function z-directive z-assembly">DWORD</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">PTR</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-hexadecimal z-assembly">0x8</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cab</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">11</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">cmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebx</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x1</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cae</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">14</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">jle</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048cd0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">48</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cb0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">16</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffff4</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cb3</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">19</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">lea</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebx</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x1</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cb6</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">22</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cb7</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">23</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048ca0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cbc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">28</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esi</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cbe</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">30</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffff4</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cc1</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">33</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">lea</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebx</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x2</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cc4</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">36</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cc5</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">37</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048ca0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cca</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">42</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">esi</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ccc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">44</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">jmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048cd5</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">53</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cce</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">46</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esi</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">esi</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cd0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">48</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x1</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cd5</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">53</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">lea</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x18</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cd8</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">56</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">pop</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebx</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cd9</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">57</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">pop</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esi</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cda</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">58</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cdc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">60</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">pop</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cdd</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">61</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">ret</span>
</span></code></pre><p>There are 3 main part on this function, the prologue (+ some other instructions) the central part of the function which is the one that produces the return value, and the epilogue.<p>Let's analyze the prologue:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">0</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca1</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">1</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca3</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">3</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">sub</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca6</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">6</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esi</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca7</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">7</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebx</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ca8</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">8</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebx</span><span class="z-source z-assembly">,</span><span class="z-support z-function z-directive z-assembly">DWORD</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-support z-function z-directive z-assembly">PTR</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-hexadecimal z-assembly">0x8</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cab</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">11</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">cmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">ebx</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0x1</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cae</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">14</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">jle</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048cd0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">48</span><span class="z-entity z-name z-function z-assembly">></span>
</span></code></pre><p>Between instructions <code>0</code> and <code>7</code> we see the function prologue and some stack allocation. After this, on instruction <code>8</code> we load the parameter of the function <code>func4</code> to the register <code>ebx</code>. This means that if in phase 4 we input a string <code>"5"</code>, then the ebx register will store an int value <code>5</code>.<p>After this, on instruction <code>11</code> it compares the function parameter with <code>1</code>, if they are less or equal than 1, then it jump to instructino <code>48</code> which is the start of the function prologue which returns the same value <code>ebx</code> .<p>Ok, so we now know that our function looks something like this in C code :<pre class="language-C z-code" data-lang=C><code class=language-C data-lang=C><span class="z-source z-c"><span class="z-storage z-type z-c">int</span> <span class="z-meta z-function z-c"><span class="z-entity z-name z-function z-c">func4</span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-storage z-type z-c">int</span> <span class="z-variable z-parameter z-c">num</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-meta z-function z-c"> </span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
  <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>num <span class="z-keyword z-operator z-comparison z-c"><=</span> <span class="z-constant z-numeric z-integer z-decimal z-c">1</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
    <span class="z-keyword z-control z-flow z-return z-c">return</span> num<span class="z-punctuation z-terminator z-c">;</span>
  <span class="z-punctuation z-section z-block z-end z-c">}</span></span> <span class="z-keyword z-control z-c">else</span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
    <span class="z-comment z-line z-double-slash z-c"><span class="z-punctuation z-definition z-comment z-c">//</span> Do some stuff
</span>  <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-end z-c">}</span></span></span>
</span></code></pre><p>Let's analyze what happens on the else, this is between instructions <code>16</code> and <code>44</code><pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-constant z-character z-hexadecimal z-assembly">0x08048cb0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">16</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffff4</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cb3</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">19</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">lea</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebx</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x1</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cb6</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">22</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cb7</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">23</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048ca0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cbc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">28</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esi</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cbe</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">30</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffff4</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cc1</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">33</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">lea</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-source z-assembly">[</span><span class="z-variable z-parameter z-register z-assembly">ebx</span><span class="z-source z-assembly">-</span><span class="z-constant z-character z-hexadecimal z-assembly">0x2</span><span class="z-source z-assembly">]</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cc4</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">36</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cc5</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">37</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048ca0</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048cca</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">42</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-variable z-parameter z-register z-assembly">esi</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048ccc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">44</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">jmp</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048cd5</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">c</span><span class="z-entity z-name z-function z-assembly">4</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">53</span><span class="z-entity z-name z-function z-assembly">></span>
</span></code></pre><p>By taking a quick look, we see that we are calling the same <code>func4</code> function on <code>func4</code> body (on isntructions <code>23</code> and <code>37</code>), this means we are dealing with a recursive function.<p>On the first call, we substract <code>1</code> from <code>ebx</code> (our input parameter) by using <code>lea</code> instruction, we then store that result on <code>eax</code>, push <code>eax</code> to the stack and call <code>func4</code> with <code>eax</code> as a parameter. So we are calling <code>func4</code> with our original functino parameter minus 1. After this, we save the return value of that function call into the <code>esi</code> register.<p>On the second call, we do something similar, but instead of calling <code>func4</code> with our original function parameter minus 1, we call it minus 2 (instruction <code>33</code> is <code>lea    eax,[ebx-0x2]</code> which substract <code>2</code> from our parameter and stores it in <code>eax</code>)<p>Finallly we add <code>esi</code> (return value of the first call) with <code>eax</code> (return value of the second call) and we jump to instruction <code>53</code><p>Or C code now looks something like this:<pre class="language-C z-code" data-lang=C><code class=language-C data-lang=C><span class="z-source z-c"><span class="z-storage z-type z-c">int</span> <span class="z-meta z-function z-c"><span class="z-entity z-name z-function z-c">func4</span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-storage z-type z-c">int</span> <span class="z-variable z-parameter z-c">num</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-meta z-function z-c"> </span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
  <span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>num <span class="z-keyword z-operator z-comparison z-c"><=</span> <span class="z-constant z-numeric z-integer z-decimal z-c">1</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
    <span class="z-keyword z-control z-flow z-return z-c">return</span> num<span class="z-punctuation z-terminator z-c">;</span>
  <span class="z-punctuation z-section z-block z-end z-c">}</span></span> <span class="z-keyword z-control z-c">else</span> <span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
    <span class="z-keyword z-control z-flow z-return z-c">return</span> <span class="z-meta z-function-call z-c"><span class="z-variable z-function z-c">func4</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c">num <span class="z-keyword z-operator z-arithmetic z-c">-</span> <span class="z-constant z-numeric z-integer z-decimal z-c">1</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span> <span class="z-keyword z-operator z-arithmetic z-c">-</span> <span class="z-meta z-function-call z-c"><span class="z-variable z-function z-c">func4</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c">num <span class="z-keyword z-operator z-arithmetic z-c">-</span> <span class="z-constant z-numeric z-integer z-decimal z-c">2</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
  <span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-end z-c">}</span></span></span>
</span></code></pre><p>Does this function sounds familiar? (Hint: It's the Fibonacci sequence)<p>Great, so now we know that our input on phase 4 has to be an integer greater than 0, that if we put it into the fibonacci function, it returns <code>0x37</code> which is <code>55</code> in decimal. This number is 10, because the 10th value of the Fibonacci sequence is 55.<p>However this function adds 1 from our input, so if we input 10, it will return the 11th number of the Fibonacci sequence, so the get <code>55</code> we have to input <code>9</code>.<p>Final solution then is <code>9</code>!<p><em>note: Idk why it does one more iteration of the sequence, for example if 10 is provided, it returns 89 isntead of 55</em></section></article></main></div><footer><section><nav><a class="nav-links social" rel="noopener noreferrer" href=https://www.linkedin.com/in/aparkerdf/ target=_blank> <img alt=linkedin src=/social_icons/linkedin.svg title=linkedin> </a><a class="nav-links social" rel="noopener noreferrer" href=https://github.com/AlvaroParker target=_blank> <img alt=github src=/social_icons/github.svg title=github> </a><a class="nav-links social" rel="noopener noreferrer" href=https://gitlab.com/AlvaroParker target=_blank> <img alt=gitlab src=/social_icons/gitlab.svg title=gitlab> </a><a class="nav-links social" rel="noopener noreferrer" href=mailto:aparkerdf@protonmail.com target=_blank> <img alt=mail src=/social_icons/email.svg title=mail> </a></nav></section><script src=https://await.cl/js/main.js></script></footer>