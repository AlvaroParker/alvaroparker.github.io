<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title> CMU Bomb Lab Phase 1 </title><link href=/menu_icon/favicon.svg rel=icon type=image/png><link href="https://blog.alvarop.dev/ atom.xml" title="Alvaro's Blog" rel=alternate type=application/atom+xml><link href=https://blog.alvarop.dev/main.css media=screen rel=stylesheet><script>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><meta content="A personal portfolio/blog website of Alvaro Parker del Fierro" name=description><meta content="A personal portfolio/blog website of Alvaro Parker del Fierro" name=description><meta content="index, nofollow" name=robots><meta content="Alvaro's Blog" property=og:title><meta content=article property=og:type><meta content=/menu_icon/profile_pic.jpg property=og:image><meta content=/menu_icon/profile_pic.jpg name=twitter:card><meta content=https://blog.alvarop.dev/posts/cmu-phase1/ property=og:url><meta content="A personal portfolio/blog website of Alvaro Parker del Fierro" property=og:description><meta content="Alvaro's Blog" property=og:site_name><body><header><div class=navbar><div class="nav-title nav-navs"><a class="nav-links home-title" href=https://blog.alvarop.dev>Alvaro's Blog</a></div><nav class="nav-title nav-navs"><a class=nav-links href=/projects> <img alt=Projects height=15 src=/menu_icon/projects.png width=15> Projects</a><a class=nav-links href=/about> <img alt=About height=15 src=/menu_icon/profile_pic.jpg width=15> About</a></nav><nav class="socials nav-navs"><label class=theme-switcher for=themeswitch><div class=background></div> <input id=themeswitch type=checkbox> <div class=switch><img alt="theme switch to dark" class=moon src=/menu_icon/moon.png><img alt="theme switch to light" class=sun src=/menu_icon/sun.png></div></label></nav></div></header><div class=content><main><article><div class=title><h2>CMU Bomb Lab Phase 1</h2><div class=meta>Posted on <time>2024-09-01</time><div class=post-tags><nav class="nav tags">üè∑: <a href=https://blog.alvarop.dev/tags/cmu-bomb/>CMU Bomb</a> ¬† <a href=https://blog.alvarop.dev/tags/reverse-engineering/>Reverse Engineering</a> ¬† <a href=https://blog.alvarop.dev/tags/code/>Code</a> ¬†</nav></div> ||<span> 4 minute read</span></div></div><h1>Table of Contents</h1><ul><li><a href=https://blog.alvarop.dev/posts/cmu-phase1/#cmu-bomb-lab-reverse-engineering>CMU Bomb Lab reverse engineering</a> <ul><li><a href=https://blog.alvarop.dev/posts/cmu-phase1/#phase-1>Phase 1</a></ul></ul><section class=body><h1 id=cmu-bomb-lab-reverse-engineering>CMU Bomb Lab reverse engineering</h1><p>This repo contains the explanation on how I solved the CMU bomb lab on reverse engineering. I mostly used <code>gdb</code> to analye and reverse engineer the code and I documented my thought process and explanations.<p>"The CMU bomb lab is a famous reverse engineering challenge from CMU.<p>This category's challenges will track your progress through the 32-bit x86 CMU bomb lab.<p>Welcome to my fiendish little bomb. You have 6 phases with which to blow yourself up. Have a nice day!"<p>If you wanna solve the challenge go to <a href=https://reversing.ctfd.io/challenges>reversing.ctfd.io</a><h2 id=phase-1>Phase 1</h2><p><em>Note: We are using AT&T assembly syntax</em><p>We have to defuse the phase 1 of the bomb<p>Using gdb<pre class="language-gdb z-code" data-lang=gdb><code class=language-gdb data-lang=gdb><span class="z-text z-plain">disassemble main
</span></code></pre><p>We have the following output:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-constant z-character z-hexadecimal z-assembly">0x08048a52</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">162</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x80491fc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">r</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">i</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048a57</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">167</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span>    <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffff4</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048a5a</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">170</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048a5b</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">171</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048b20</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048a60</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">176</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x804952c</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">f</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">></span>
</span></code></pre><p>On instruction <code>162</code> we see a call to read line corresponding to the first input the program expects when executing <code>./bomb</code>. After this, a function <code>phase_1</code> is called.<p>disassembling the function <code>phase_1</code> on <code>gdb</code> gives us the following:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-constant z-character z-hexadecimal z-assembly">0x08048b20</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">0</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b21</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">1</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b23</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">3</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">sub</span>    <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0x8</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b26</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">6</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8</span><span class="z-entity z-name z-function z-assembly">(</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-entity z-name z-function z-assembly">)</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b29</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">9</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span>    <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0xfffffff8</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b2c</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">12</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span>   <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0x80497c0</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b31</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">17</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b32</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">18</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8049030</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">r</span><span class="z-entity z-name z-function z-assembly">i</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">g</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">q</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b37</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">23</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span>    <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b3a</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">26</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">test</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b3c</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">28</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">je</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048b43</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">35</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b3e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">30</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x80494fc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">x</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">m</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b43</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">35</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b45</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">37</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">pop</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x08048b46</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">38</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly">:</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">ret</span>
</span></code></pre><p>We have the prologue on the first two instructions, then a subtraction to the <code>esp</code> pointer indicating that we are allocating space on the stack.<p>Let's put a breakpoint after the prologue and stack allocation:<pre class=z-code><code><span class="z-text z-plain">b *(phase_1+12)
</span></code></pre><p>Now let's run our program!<pre class=z-code><code><span class="z-text z-plain">run
</span></code></pre><p>We see that we our program started and now is waiting for standard input on the console:<pre class=z-code><code><span class="z-text z-plain">Starting program: /home/user/Documents/reversing.ctfd.io/phase1/bomb
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/usr/lib/libthread_db.so.1".
Welcome to my fiendish little bomb. You have 6 phases with
which to blow yourself up. Have a nice day!
>
</span></code></pre><p>So let's put a random string on the prompt!<pre class=z-code><code><span class="z-text z-plain">> Hello world, this is a string!!!!
</span></code></pre><p>We now have reached our breakpoint that we set earlier:<pre class=z-code><code><span class="z-text z-plain">Starting program: /home/user/Documents/reversing.ctfd.io/phase1/bomb
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/usr/lib/libthread_db.so.1".
Welcome to my fiendish little bomb. You have 6 phases with
which to blow yourself up. Have a nice day!
Hello world, this is a string!!!

Breakpoint 1, 0x08048b2c in phase_1 ()
</span></code></pre><p>You can see where in the program you are by doing<pre class=z-code><code><span class="z-text z-plain">lay next
</span></code></pre><p>We see the following:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-entity z-name z-function z-assembly">B</span><span class="z-source z-assembly">+</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048b2c</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">12</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span>   <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0x80497c0</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b31</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">17</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b32</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">18</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8049030</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">r</span><span class="z-entity z-name z-function z-assembly">i</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">g</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">q</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b37</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">23</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span>    <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b3a</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">26</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">test</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b3c</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">28</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">je</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048b43</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">35</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b3e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">30</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x80494fc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">x</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">m</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b43</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">35</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b45</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">37</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">pop</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b46</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">38</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">ret</span>
</span></code></pre><p>We are at the instruction <code>12</code> on the function <code>phase_1</code>. We see that there's an incoming function call <code>strings_not_equal</code> so let's set a breakpoint there to analize the arguments that this function is called with:<pre class=z-code><code><span class="z-text z-plain">b *(phase_1+18)
</span></code></pre><p>And let's continue:<pre class=z-code><code><span class="z-text z-plain">c
</span></code></pre><p>We are now on the instruction <code>18</code> on the function <code>phase_1</code>:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-entity z-name z-function z-assembly">B</span><span class="z-source z-assembly">+</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048b2c</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">12</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span>   <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0x80497c0</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b31</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">17</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-entity z-name z-function z-assembly">B</span><span class="z-source z-assembly">+</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048b32</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">18</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8049030</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">r</span><span class="z-entity z-name z-function z-assembly">i</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">g</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">n</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">t</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">q</span><span class="z-entity z-name z-function z-assembly">u</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b37</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">23</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">add</span>    <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0x10</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b3a</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">26</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">test</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b3c</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">28</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">je</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048b43</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">35</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b3e</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">30</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">call</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x80494fc</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">x</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">l</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">d</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">o</span><span class="z-entity z-name z-function z-assembly">m</span><span class="z-entity z-name z-function z-assembly">b</span><span class="z-entity z-name z-function z-assembly">></span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b43</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">35</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">mov</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span><span class="z-source z-assembly">,</span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">esp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b45</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">37</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">pop</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">ebp</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b46</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">38</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">ret</span>
</span></code></pre><p>So let's check the arguments! We see that the arguments are passed using the stack (there are two <code>push</code>) instructions before our function is called:<pre class="language-nasm z-code" data-lang=nasm><code class=language-nasm data-lang=nasm><span class="z-source z-assembly"><span class="z-entity z-name z-function z-assembly">B</span><span class="z-source z-assembly">+</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-constant z-character z-hexadecimal z-assembly">0x8048b2c</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">12</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span>   <span class="z-support z-function z-directive z-assembly">$</span><span class="z-constant z-character z-hexadecimal z-assembly">0x80497c0</span>
<span class="z-constant z-character z-hexadecimal z-assembly">0x8048b31</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"><</span><span class="z-entity z-name z-function z-assembly">p</span><span class="z-entity z-name z-function z-assembly">h</span><span class="z-entity z-name z-function z-assembly">a</span><span class="z-entity z-name z-function z-assembly">s</span><span class="z-entity z-name z-function z-assembly">e</span><span class="z-entity z-name z-function z-assembly">_</span><span class="z-entity z-name z-function z-assembly">1</span><span class="z-source z-assembly">+</span><span class="z-constant z-character z-decimal z-assembly">17</span><span class="z-entity z-name z-function z-assembly">></span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-keyword z-control z-assembly">push</span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly"> </span><span class="z-entity z-name z-function z-assembly">%</span><span class="z-variable z-parameter z-register z-assembly">eax</span>
</span></code></pre><p>Let's check those values (<code>%eax</code> and <code>0x80497c0</code>) using gdb:<pre class=z-code><code><span class="z-text z-plain">x/s $eax
> 0x804b680 &LTinput_strings>:      "hello"

x/s 0x80497c0
> 0x80497c0:      "Public speaking is very easy."
</span></code></pre><p>Huh, we can see that the two arguments passed to the <code>strings_not_equal</code> function are the string we input in the beggining and another string. These must be the first phase flag!!!<p>Solution: <code>"Public speaking is very easy"</code></section></article></main></div><footer><section><nav><a class="nav-links social" rel="noopener noreferrer" href=https://www.linkedin.com/in/aparkerdf/ target=_blank> <img alt=linkedin src=/social_icons/linkedin.svg title=linkedin> </a><a class="nav-links social" rel="noopener noreferrer" href=https://github.com/AlvaroParker target=_blank> <img alt=github src=/social_icons/github.svg title=github> </a><a class="nav-links social" rel="noopener noreferrer" href=https://gitlab.com/AlvaroParker target=_blank> <img alt=gitlab src=/social_icons/gitlab.svg title=gitlab> </a><a class="nav-links social" rel="noopener noreferrer" href=mailto:aparkerdf@protonmail.com target=_blank> <img alt=mail src=/social_icons/email.svg title=mail> </a></nav></section><script src=https://blog.alvarop.dev/js/main.js></script></footer>